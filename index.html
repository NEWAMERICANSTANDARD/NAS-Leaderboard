<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>NAS Leaderboard</title>
  <style>body { text-align:center; font-family:sans-serif; background:#0a0a0a; color:#fff; } table { margin:auto; border-collapse: collapse; } th, td { padding:8px 12px; border:1px solid #444; }</style>
</head>
<body>
  <h1>NAS Leaderboard</h1>
  <table id="lb"><thead><tr><th>Rank</th><th>Name</th><th>Tier</th><th>Score</th></tr></thead><tbody></tbody></table>
  <script>
    const URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT15cYvooOqX2_SicJIooVvhI2gGGWuPhMO0ALpWIcLw-xBPt9V9QFDbtn5CJ1RZZoYeUqEgUnJkfDu/pubhtml?gid=1747425104&single=true";
    fetch(URL).then(r => r.text()).then(t => {
      if(!t.includes("setResponse")) throw "Sheet not published correctly.";
      const json = JSON.parse(t.match(/setResponse\((.*)\)/s)[1]);
      const cols = json.table.cols.map(c => c.label.toLowerCase());
      const rows = json.table.rows.map((r, i) => ({
        name: r.c[cols.indexOf("name")]?.v || "",
        tier: r.c[cols.indexOf("highest tier")]?.v || "",
        score: r.c[cols.indexOf("best score")]?.v || ""
      }));
      const tbody = document.querySelector("#lb tbody");
      rows.forEach((row, idx) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${idx+1}</td><td>${row.name}</td><td>${row.tier}</td><td>${row.score}</td>`;
        tbody.appendChild(tr);
      });
    }).catch(err => {
      document.body.innerHTML += "<p style='color:red;'>Error loading leaderboard. Check sheet publishing.</p>";
      console.error(err);
    });
  </script>
</body>
</html>



